version: "1.0"
rules:
  - id: RAG-001
    name: RAG Document Prompt Injection
    description: RAG 문서 내 프롬프트 주입 패턴 탐지
    category: indirect_injection
    severity: critical
    action: block
    isActive: true
    priority: 95
    patterns:
      - type: regex
        value: "\\[INST\\]"
        flags: i
      - type: regex
        value: "<<SYS>>"
        flags: i
      - type: regex
        value: "<\\|im_start\\|>"
        flags: i
      - type: regex
        value: "ignore\\s+(all\\s+)?previous\\s+instructions?"
        flags: i
      - type: regex
        value: "you\\s+are\\s+now\\s+"
        flags: i
      - type: regex
        value: "시스템\\s*(프롬프트|명령|지시)"

  - id: RAG-002
    name: RAG Invisible Character Attack
    description: RAG 문서 내 비가시 문자(Zero-Width 등) 삽입 공격 탐지
    category: indirect_injection
    severity: high
    action: block
    isActive: true
    priority: 90
    patterns:
      - type: regex
        value: "[\\u200b\\u200c\\u200d\\u200e\\u200f\\u2060\\ufeff]"
      - type: regex
        value: "[\\u2061\\u2062\\u2063\\u2064\\u00ad]"

  - id: RAG-003
    name: RAG Encoding Attack
    description: RAG 문서 내 Base64 인코딩을 이용한 지시문 숨김 공격 탐지
    category: indirect_injection
    severity: high
    action: block
    isActive: true
    priority: 85
    patterns:
      - type: regex
        value: "(?:[A-Za-z0-9+/]{4}){12,}(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)"
